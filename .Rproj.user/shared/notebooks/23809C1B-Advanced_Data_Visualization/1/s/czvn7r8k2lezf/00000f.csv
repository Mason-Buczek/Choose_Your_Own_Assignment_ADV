"0","# Load libraries"
"0","library(ggplot2)"
"2","Warning: package ‘ggplot2’ was built under R version 4.3.2"
"0","library(reshape2)"
"0","library(readxl)"
"0","library(pheatmap)"
"0",""
"0","# Load the data from the Excel file"
"0","data <- read_excel(""person_data.xlsx"")"
"0",""
"0","# Convert Date to Date type and format to remove year"
"0","data$Date <- format(as.Date(data$Date, format = ""%Y-%m-%d""), ""%m-%d"")"
"0",""
"0","# Create a column for clothes combination"
"0","data$Clothes_Combo <- paste(data$Clothes_Bottom, data$Clothes_Top, sep = "" - "")"
"0",""
"0","# Create a matrix for the heatmap"
"0","heatmap_data <- dcast(data, Clothes_Combo ~ Date, value.var = ""Day_Max_Temp"")"
"0",""
"0","# Convert to matrix format for heatmap"
"0","heatmap_matrix <- as.matrix(heatmap_data[, -1])"
"0","rownames(heatmap_matrix) <- heatmap_data$Clothes_Combo"
"0",""
"0","# Define color palette with blue for lower temperatures and red for higher temperatures"
"0","my_palette <- colorRampPalette(c(""blue"", ""red""))(100)"
"0",""
"0","# Plot heatmap with customized color palette"
"0","p <- pheatmap(heatmap_matrix, "
"0","              cluster_rows = FALSE, "
"0","              cluster_cols = FALSE,"
"0","              show_rownames = TRUE,"
"0","              show_colnames = TRUE,"
"0","              main = ""Heatmap of Day Max Temperature by Clothes Combination"","
"0","              color = my_palette)"
